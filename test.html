<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameChanger Wallet Connect</title>
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/client@1.8.0/dist/umd/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emurgo/cardano-serialization-lib-browser"></script>
</head>
<body>
    <h1>GameChanger Wallet Connect</h1>
    <button id="connect-wallet">Connect Wallet</button>
    <div id="wallet-info"></div>

    <script>
        // WalletConnect and GameChanger Integration
        const connectWalletButton = document.getElementById("connect-wallet");
        const walletInfoDiv = document.getElementById("wallet-info");

        let walletConnector;

        connectWalletButton.addEventListener("click", async () => {
            // Initialize WalletConnect
            walletConnector = new WalletConnect.default({
                bridge: "https://bridge.walletconnect.org", // Required bridge
            });

            // Check if already connected
            if (!walletConnector.connected) {
                // Create a new session
                walletConnector.createSession();
            }

            // Subscribe to connection events
            walletConnector.on("connect", (error, payload) => {
                if (error) {
                    console.error("Connection Error:", error);
                    return;
                }

                // Get wallet info
                const { accounts, chainId } = payload.params[0];
                walletInfoDiv.innerHTML = `
                    <p>Connected Wallet Address: ${accounts[0]}</p>
                    <p>Connected Chain ID: ${chainId}</p>
                `;
            });

            walletConnector.on("disconnect", (error, payload) => {
                if (error) {
                    console.error("Disconnection Error:", error);
                    return;
                }

                walletInfoDiv.innerHTML = "<p>Wallet Disconnected</p>";
            });

            // Open WalletConnect QR modal
            if (walletConnector.uri) {
                window.open(`https://gamechanger.finance/connect/?uri=${encodeURIComponent(walletConnector.uri)}`, "_blank");
            }
        });
    </script>
</body>
</html>
